class Kleur{luminance(t){var r=[t[0],t[1],t[2]].map(function(t){return(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*r[0]+.7152*r[1]+.0722*r[2]}contrast(t,r){var e=luminance(t),a=luminance(r),h=Math.max(e,a),n=Math.min(e,a);return result=(h+.05)/(n+.05),result<1&&(result=1/result),result}rgb_xyz(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}xyz_lab(t){return t>.008856452?Math.pow(t,1/3):t/.12841855+.12841855}lab_xyz(t){return t>.206896552?t*t*t:.12841855*(t-.12841855)}rgb_to_xyz(t){let r=t[0],e=t[1],a=t[2];r=this.rgb_xyz(r),e=this.rgb_xyz(e),a=this.rgb_xyz(a);let h=this.xyz_lab((.4124564*r+.3575761*e+.1804375*a)/.95047),n=this.xyz_lab((.2126729*r+.7151522*e+.072175*a)/1),o=this.xyz_lab((.0193339*r+.119192*e+.9503041*a)/1.08883);return[Number(h.toFixed(4)),Number(n.toFixed(4)),Number(o.toFixed(4))]}lab_to_lch(t){var r=t[0],e=t[1],a=t[2],h=Math.sqrt(e*e+a*a),n=(Math.atan2(a,e)*(180/3.14)+360)%360;return 0===Math.round(1e4*h)&&(n=Number.NaN),[Math.round(r),Math.round(h),Math.round(n)]}rgb_to_lab(t){let r=t[0],e=t[1],a=t[2],h=Math.round(116*e-16);return[h<0?0:h,Math.round(500*(r-e)),Math.round(200*(e-a))]}difference(t,r){return Delta=Math.sqrt((t[0]-r[0])**2+(t[1]-r[1])**2+(t[2]-r[2])),Delta/100}componentToHex(t){var r=t.toString(16);return 1==r.length?"0"+r:r}hexToRgb(t){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]}rgbToHex(t,r,e){return"#"+this.componentToHex(t)+this.componentToHex(r)+this.componentToHex(e)}groupBy(t,r){const e=new Map;return t.forEach(t=>{const a=r(t),h=e.get(a);h?h.push(t):e.set(a,[t])}),e}rgb_to_hsv(t){let r=t[0]/255,e=t[1]/255,a=t[2]/255,h=Math.max(r,e,a),n=Math.min(r,e,a);if(t[0]==t[1]&&t[1]==t[2]&&t[2]==t[0])return[0,0,Math.round(100*h)];let o,u=h-n;return r===h?o=(e-a)/u:e===h?o=2+(a-r)/u:a===h?o=4+(r-e)/u:console.log("wrong"),(o*=60)<0&&(o+=360),[Math.round(o),Math.round(u/h*100),Math.round(100*h)]}setup(t,r,e){return r.canvas.width=e.width,r.canvas.height=e.height,r.drawImage(imageObj,0,0,e.width,e.height),r.getImageData(0,0,t.width,t.height).data}generateColorArray(t){let r=[];for(var e=0;e<t.length;e+=4){let o={};var a=t[e],h=t[e+1],n=t[e+2];t[e+3];o.hex=this.rgbToHex(a,h,n),r.push(o)}const o=this.groupBy(r,t=>t.hex);o.forEach(function(t,r){o.set(r,t.length)}),o.forEach(t=>{t.count<imageObj.height*imageObj.width/100&&o.pop(t)});const u=new Map([...o.entries()].sort((t,r)=>r[1]-t[1]));let l,s,i=[];for([l,s]of u.entries()){let t=this.hexToRgb(l),r={};r.hex=l,r.rgb=t,r.hsv=this.rgb_to_hsv(t),r.xyz=this.rgb_to_xyz(t),r.lab=this.rgb_to_lab(r.xyz),r.lch=this.lab_to_lch(r.lab),r.count=s,i.push(r)}return i}getSwatch(t){for(i=0;i<t.length;i++)Math.abs(t[i].lab[1]-t[i].lab[2])>20&&light.push(t[i]);return[]}getRandomSwatch(t){let r=[];for(let e=0;e<20;e++){let e=t[Math.floor(Math.random()*t.length)];r.push(e)}return r.sort((t,r)=>parseFloat(t.count)-parseFloat(r.count)),r}getLightColors(t){let r=[];return t.forEach(t=>{t.lab[0]>60&&r.push(t)}),r}getDarkColors(t){let r=[];return t.forEach(t=>{t.lab[0]<60&&r.push(t)}),r}getDominant(t){return t[0]}makeDarker(t){let r=this.hexToRgb(t);return this.rgbToHex(Math.round(r[0]/4),Math.round(r[1]/4),Math.round(r[2]/4))}getVIbrant(t,r=30){let e=[];for(let a=0;a<t.length;a++)Math.abs(t[a].lab[1]-t[a].lab[2])>r&&e.push(t[a]);return e}}
